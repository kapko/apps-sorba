!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@ionic-native/keyboard/ngx"),require("@ionic-native/keyboard/ngx/index"),require("@ionic-native/in-app-browser/ngx"),require("@ionic-native/in-app-browser/ngx/index"),require("immutability-helper"),require("@sorba-app/sorba-ui-components"),require("@angular/common"),require("@agm/core"),require("@angular/platform-browser"),require("@angular/router"),require("@angular/forms"),require("graphql-tag"),require("@ionic-native/document-viewer/ngx"),require("@ionic-native/file/ngx"),require("@ionic-native/file-opener/ngx"),require("@ionic/angular"),require("rxjs"),require("rxjs/operators"),require("@angular/cdk/scrolling"),require("@angular/core"),require("apollo-angular"),require("apollo-cache-inmemory")):"function"==typeof define&&define.amd?define("contacts",["exports","@ionic-native/keyboard/ngx","@ionic-native/keyboard/ngx/index","@ionic-native/in-app-browser/ngx","@ionic-native/in-app-browser/ngx/index","immutability-helper","@sorba-app/sorba-ui-components","@angular/common","@agm/core","@angular/platform-browser","@angular/router","@angular/forms","graphql-tag","@ionic-native/document-viewer/ngx","@ionic-native/file/ngx","@ionic-native/file-opener/ngx","@ionic/angular","rxjs","rxjs/operators","@angular/cdk/scrolling","@angular/core","apollo-angular","apollo-cache-inmemory"],e):e(t.contacts={},t.ngx,t.i1,t.ngx$1,t.i1$1,t.update,t.sorbaUiComponents,t.ng.common,t.core,t.ng.platformBrowser,t.ng.router,t.ng.forms,t.gql,t.ngx$2,t.ngx$3,t.ngx$4,t.i1$2,t.rxjs,t.rxjs.operators,t.ng.cdk.scrolling,t.ng.core,t.i1$3,t.apolloCacheInmemory)}(this,function(t,e,n,i,o,r,a,s,c,l,p,u,d,h,f,g,m,b,v,y,x,w,I){"use strict";r=r?r["default"]:r,d=d?d["default"]:d;var k=function(t,e){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function C(t,e){function n(){this.constructor=t}k(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var j=function(){return(j=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function P(e,a,s,c){return new(s=s||Promise)(function(t,n){function i(t){try{r(c.next(t))}catch(e){n(e)}}function o(t){try{r(c["throw"](t))}catch(e){n(e)}}function r(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(i,o)}r((c=c.apply(e,a||[])).next())})}function S(i,o){var r,a,s,t,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function n(t){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,a&&(s=2&t[0]?a["return"]:t[0]?a["throw"]||((s=a["return"])&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,a=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){c.label=t[1];break}if(6===t[0]&&c.label<s[1]){c.label=s[1],s=t;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(t);break}s[2]&&c.ops.pop(),c.trys.pop();continue}t=o.call(i,c)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}function M(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function H(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var T="contacts",D="contact",A="notifications",$="Contacts",L="user",_="company",O="all",E="domains",q="activeLanguage",B=[{count:0,type:O,label:"All contacts",active:!0},{count:0,type:L,label:"User contacts",active:!1},{count:0,type:_,label:"Company contacts",active:!1}],F=[{menuItemIcon:"contact",menuItemName:"Contact list",menuItemLink:"#/contacts/contact",subMenu:[]},{menuItemIcon:"outlook",menuItemName:"Outlook export",menuItemLink:"#/contacts/contact",subMenu:[]},{menuItemIcon:"report",menuItemName:"Reports",menuItemLink:"#/contacts/contact",subMenu:[{subMenuItemName:"Number ranges",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Default values",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Address import",subMenuItemLink:"#/contacts/contact"}]},{menuItemIcon:"mutations",menuItemName:"Global mutations",menuItemLink:"#/contacts/contact",subMenu:[]},{menuItemIcon:"settings-filled",menuItemName:"Settings",menuItemLink:"#/contacts/contact",subMenu:[{subMenuItemName:"Number ranges",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Default values",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Address import",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Subdivisions",subMenuItemLink:"#/contacts/contact"}]}],N="privacy-policy",U="/assets/docs/2019_AGB_SORBA_EDV_AG.pdf",W="https://support.sorba.ch/hc/de",z={clearcache:"yes",clearsessioncache:"yes",hideurlbar:"yes",location:"no",zoom:"no"},R="mobile",V="android",G="ios",Q="mobileweb",K="desktop",Y="tablet",J=(X.prototype.searchBySymbol=function(t,e){var s=e.toLowerCase();return t.map(function(t){var e,n,i;try{for(var o=M(Object.keys(t)),r=o.next();!r.done;r=o.next())if(t[i=r.value]&&"geocode_address"!==i&&(""+t[i]).toLowerCase().includes(s))return j({},t,{subText:t[i]})}catch(a){e={error:a}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(e)throw e.error}}}).filter(function(t){return!!t})},X.prototype.getMobileHeight=function(t){return"calc(100vh - var(--header-height) - var(--ion-safe-area-top, 0) - "+t+")"},X.prototype.getActiveDomain=function(){var n=this;return new Promise(function(e,t){n.isTablet||n.isMobile?n.appService.getActiveDomain().pipe(v.take(1)).subscribe(function(t){e(t)}):e(n.urlUtils.getSubDomain())})},X.prototype.filterByType=function(t,e){return t===e||e===O},X.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],X.ctorParameters=function(){return[{type:undefined,decorators:[{type:x.Inject,args:["appService"]}]},{type:undefined,decorators:[{type:x.Inject,args:["urlUtils"]}]}]},X.ngInjectableDef=x.defineInjectable({factory:function(){return new X(x.inject("appService"),x.inject("urlUtils"))},token:X,providedIn:"root"}),X);function X(t,e){this.appService=t,this.urlUtils=e,this.isMobile=window.innerWidth<768,this.isDesktop=1023<window.innerWidth,this.isTablet=768<=window.innerWidth&&window.innerWidth<1024,this.desktopHeight="calc(100vh - var(--header-height) - var(--ion-safe-area-top, 0) - 277px)",this.activeContact=new b.BehaviorSubject(null),this.activeLanguage$=new b.BehaviorSubject("ENGLISH"),this.headerData=new b.BehaviorSubject({title:$,path:"/"})}var Z=(tt.prototype.setKeyboardMode=function(){this.keyboard.setResizeMode(e.KeyboardResizeMode.Native)},tt.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],tt.ctorParameters=function(){return[{type:e.Keyboard}]},tt.ngInjectableDef=x.defineInjectable({factory:function(){return new tt(x.inject(n.Keyboard))},token:tt,providedIn:"root"}),tt);function tt(t){var e=this;this.keyboard=t,this.keyboardHeight$=new b.BehaviorSubject(null),window.addEventListener("keyboardDidHide",function(){return e.keyboardHeight$.next(null)}),window.addEventListener("keyboardWillShow",function(t){return e.keyboardHeight$.next(t.keyboardHeight)})}var et=(nt.prototype.redirect=function(t,e){t.preventDefault(),this.iab.create(e,"_blank",z)},nt.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],nt.ctorParameters=function(){return[{type:i.InAppBrowser}]},nt.ngInjectableDef=x.defineInjectable({factory:function(){return new nt(x.inject(o.InAppBrowser))},token:nt,providedIn:"root"}),nt);function nt(t){this.iab=t}var it=(ot.prototype.isMobileWeb=function(){return this.plt.is(Q)},ot.prototype.isDesktop=function(){return this.plt.is(K)},ot.prototype.isMobileApp=function(){return this.plt.is(R)},ot.prototype.isIOS=function(){return this.plt.is(G)},ot.prototype.isAndroid=function(){return this.plt.is(V)},ot.prototype.isTablet=function(){return this.plt.is(Y)},ot.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],ot.ctorParameters=function(){return[{type:m.Platform}]},ot.ngInjectableDef=x.defineInjectable({factory:function(){return new ot(x.inject(m.Platform))},token:ot,providedIn:"root"}),ot);function ot(t){this.plt=t}var rt,at,st,ct=d(rt=rt||H(["\n  fragment ContactAppInfo on AppContact {\n    business_number\n    mobile_number\n    first_name\n    private_number\n    fax\n    website\n    address\n    logical20\n    name\n    id\n    postal_code\n    city\n    po_box\n  }\n"],["\n  fragment ContactAppInfo on AppContact {\n    business_number\n    mobile_number\n    first_name\n    private_number\n    fax\n    website\n    address\n    logical20\n    name\n    id\n    postal_code\n    city\n    po_box\n  }\n"])),lt=d(st=st||H(["\n  query ContactApps($domain: String!, $page: UInt!, $perPage: UInt!) {\n    contactApps(domain: $domain, page: $page, perPage: $perPage) {\n      items {\n        ...ContactAppInfo\n      }\n      pageInfo {\n        totalCount\n      }\n    }\n  }\n  ","\n"],["\n  query ContactApps($domain: String!, $page: UInt!, $perPage: UInt!) {\n    contactApps(domain: $domain, page: $page, perPage: $perPage) {\n      items {\n        ...ContactAppInfo\n      }\n      pageInfo {\n        totalCount\n      }\n    }\n  }\n  ","\n"]),ct),pt=(C(ut,at=w.Query),ut.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],ut.ngInjectableDef=x.defineInjectable({factory:function(){return new ut(x.inject(w.Apollo))},token:ut,providedIn:"root"}),ut);function ut(){var t=null!==at&&at.apply(this,arguments)||this;return t.document=lt,t}var dt,ht,ft=(C(gt,dt=w.Query),gt.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],gt.ngInjectableDef=x.defineInjectable({factory:function(){return new gt(x.inject(w.Apollo))},token:gt,providedIn:"root"}),gt);function gt(){var t=null!==dt&&dt.apply(this,arguments)||this;return t.document=d(ht=ht||H(["\n        query language{\n            languages\n        }\n    "],["\n        query language{\n            languages\n        }\n    "])),t}var mt,bt,vt=d(bt=bt||H(["\n  query ContactAppByID($id: ID!, $domain: String!) {\n    contactAppById(id: $id, domain: $domain) {\n      ...ContactAppInfo\n      geocode_address {\n        lat\n        lon\n      }\n    }\n  }\n  ","\n"],["\n  query ContactAppByID($id: ID!, $domain: String!) {\n    contactAppById(id: $id, domain: $domain) {\n      ...ContactAppInfo\n      geocode_address {\n        lat\n        lon\n      }\n    }\n  }\n  ","\n"]),ct),yt=(C(xt,mt=w.Query),xt.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],xt.ngInjectableDef=x.defineInjectable({factory:function(){return new xt(x.inject(w.Apollo))},token:xt,providedIn:"root"}),xt);function xt(){var t=null!==mt&&mt.apply(this,arguments)||this;return t.document=vt,t}function wt(t){return t.join(" ").trim().replace(/\s{2,}/g," ")}var It=(Object.defineProperty(kt.prototype,"menuFloat",{get:function(){return this.windowWidth<1024&&767<this.windowWidth},enumerable:!0,configurable:!0}),kt.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},kt.prototype.ngAfterViewInit=function(){this.toggleMenu(),this.keyboardHelper.setKeyboardMode()},kt.prototype.ngAfterContentChecked=function(){this.cd.detectChanges()},Object.defineProperty(kt.prototype,"desktopHeight",{get:function(){if(!this.isMobile){var t=this.rightPanel&&this.rightPanel.nativeElement&&this.rightPanel.nativeElement.getElementsByClassName("contact-details-body"),e=t&&t[0]&&48<t[0].offsetHeight&&t[0].offsetHeight-48;return e?e-73:0}},enumerable:!0,configurable:!0}),kt.prototype.setContactsGql=function(){return P(this,void 0,void 0,function(){var e,n=this;return S(this,function(t){switch(t.label){case 0:return[4,this.contactsHelper.getActiveDomain()];case 1:return e=t.sent(),this.contactsGqlQuery=this.contactListGQL.watch({domain:e,page:this.page,perPage:this.itemsPerPage}),this.contactsGqlQuery.valueChanges.pipe(v.takeUntil(this.unsubscribe$),v.map(function(t){return t.data.contactApps})).subscribe(function(t){var e=n.countContacts(t);!function i(t,n){return t.sort(function(t,e){return t[n].localeCompare(e[n])})}(e,"text"),n.contactsCopy=e,n.contactsList=e}),[2]}})})},kt.prototype.getActiveLanguage=function(){var e=this;this.storageService.getValue(q).then(function(t){t&&e.contactsHelper.activeLanguage$.next(t)})},kt.prototype.selectContactItem=function(e){return P(this,void 0,void 0,function(){return S(this,function(t){return this.contactsHelper.activeContact.next(e),this.isMobile&&this.router.navigate(["/"+T+"/"+e.id]),[2]})})},kt.prototype.searchEvent=function(t){this.searchText=t},kt.prototype.fetchMore=function(){this.contactsGqlQuery.fetchMore({variables:{page:++this.page},updateQuery:function(t,e){var n=e.fetchMoreResult;return n?r(t,{contactApps:{items:{$push:n.contactApps.items},pageInfo:{$merge:n.contactApps.pageInfo}}}):t}})},kt.prototype.filterByMenu=function(e){var n=this;this.contactsList=this.contactsCopy.filter(function(t){return n.contactsHelper.filterByType(t.type,e.type)}),this.isMobile||this.selectFirstContact()},kt.prototype.countContacts=function(t){var e=t.items,n=t.pageInfo.totalCount,i=0,o=0,r=e.map(function(t){var e,n=wt([t.first_name,t.name]);return e=t.logical20?(i++,_):(o++,L),Object.assign({},t,{text:n,type:e})});return this.setMenuCount({companyCount:i,userCount:o,totalCount:n}),r},kt.prototype.setMenuCount=function(n){this.totalCountContacts=n.totalCount,this.menuItems=B.map(function(t){var e={};switch(t.type){case L:e={count:n.userCount};break;case _:e={count:n.companyCount};break;default:e={count:n.totalCount}}return Object.assign({},t,e)})},kt.prototype.selectFirstContact=function(){0<this.contactsList.length&&this.selectContactItem(this.contactsList[0])},kt.prototype.toggleMenu=function(){var e=this;this.keyboardHelper.keyboardHeight$.pipe(v.takeUntil(this.unsubscribe$)).subscribe(function(t){e.mobileHeight=e.contactsHelper.getMobileHeight(t?"96px":"152px"),e.showMenu=!!t})},kt.decorators=[{type:x.Component,args:[{selector:"lib-contacts",template:'\x3c!--sidebar--\x3e\n<sr-sidemenu\n  *ngIf="!showMenu"\n  openMenuText="menu"\n  closeMenuText="close"\n  [data]="menuData"\n  [windowWidth]="windowWidth"\n  [isMenuFloat]="menuFloat"\n></sr-sidemenu>\n\n<sr-content-card\n  class="contacts-container"\n  *ngIf="contactsList?.length; else loading"\n>\n  <div class="left-panel">\n    <header class="contacts-list-header">\n      <div class="top-block">\n        <lib-selected-menu\n          [items]="menuItems"\n          (selectedEvent)="filterByMenu($event)"\n        ></lib-selected-menu>\n        <sr-button\n          *ngIf="!showMenu"\n          buttonType="icon"\n          svgIcon="contact-add"\n          class="contact-add"\n        ></sr-button>\n      </div>\n\n      <lib-search-contacts\n        [scrollHeight]="desktopHeight"\n        [searchList]="contactsList"\n        (searchEvent)="searchEvent($event)"\n        (selectContactItem)="selectContactItem($event)"\n      ></lib-search-contacts>\n    </header>\n\n    <lib-scroller\n      [scrollHeight]="desktopHeight"\n      [totalCountContacts]="totalCountContacts"\n      *ngIf="!searchText.length"\n      (fetchMore)="fetchMore()"\n      [activeItemId]="(contactsHelper.activeContact | async)?.id"\n      (selectContact)="selectContactItem($event)"\n      [contacts]="contactsList"\n    ></lib-scroller>\n  </div>\n\n  \x3c!-- user details column--\x3e\n  <div class="right-panel" #rightPanel *ngIf="!isMobile">\n    <div class="contact-details-body">\n      <lib-contact-detail></lib-contact-detail>\n    </div>\n  </div>\n</sr-content-card>\n\n<ng-template #loading>\n  <sr-progress-spinner backdropColor="#fff"></sr-progress-spinner>\n</ng-template>\n',encapsulation:x.ViewEncapsulation.None,changeDetection:x.ChangeDetectionStrategy.OnPush,styles:[".contacts-list-header .top-block{display:flex;align-items:center;justify-content:space-between;padding:14px 8px 14px 12px}.contacts-list-header .mat-button-wrapper sr-text{order:-1}.contacts-list-header .mat-icon-button.text{font-weight:600}.contact-add .mat-icon-button.icon{color:var(--sr-base-color)}.search-field .input-wrapper{display:flex;align-items:center;height:48px;padding:4px 16px 4px 28px;border-top:1px solid var(--sr-border-color);border-bottom:1px solid var(--sr-border-color)}.search-field .input-wrapper sr-icon{color:var(--base-gray-64)}.search-field .input-wrapper input{width:100%;padding:0;border:0;font-weight:600}.search-field .input-wrapper .search-icon{margin-right:16px}.search-field .no-data{display:block;padding:16px 16px 16px 68px}@media (max-width:767px){.contacts-container .contact-add{position:fixed;right:8px;bottom:8px;z-index:71}}ion-spinner{margin:0 auto;display:block}@media (min-width:768px){.contacts-container .content-card{display:flex}.contacts-container .left-panel{width:263px;border-right:1px solid var(--sr-border-color);border-bottom-left-radius:5px;overflow:hidden}.contacts-container .right-panel{width:calc(100% - 263px)}.contacts-list-header .top-block{height:72px;padding:3px 16px 4px 24px}.filter-menu{min-width:226px;max-width:300px;margin:8px 0 0 -24px}}.info-section{padding:16px 12px;border-top:1px solid var(--sr-border-color)}.info-section .link{display:inline-block;color:var(--sr-base-color);line-height:24px;text-decoration:none}.info-section .link:focus,.info-section .link:hover{text-decoration:underline}.info-section .section-header{display:flex;align-items:center;justify-content:space-between;min-height:40px}.info-section .section-header sr-heading{color:var(--sr-light-text-color)}.info-section .section-body{margin:10px 0 8px}.info-section .section-body .button-wrapper{padding-left:44px;margin-top:21px}.info-section .section-info-field{display:flex}.info-section .section-info-field:not(:first-child){margin-top:11px}.info-section .section-info-field .field-content{flex-grow:1}.info-section .section-info-field .field-content.contact{display:flex}.info-section .section-info-field .field-content.contact sr-avatar{margin-right:12px}.info-section .section-info-field .field-content.contact sr-link{display:block;margin-top:6px}.info-section .section-info-field .field-content.project{display:flex}.info-section .section-info-field .field-content.project sr-font-icon,.info-section .section-info-field .field-content.project sr-icon{color:var(--base-gray-64)}.info-section .section-info-field .field-content.project .price-label{display:inline-block;margin:6px 0 0}.info-section .section-info-field .field-content.project .icon-wrapper{min-width:32px;margin-right:12px;text-align:center}.info-section .section-info-field .field-content.project .divider{display:none}.info-section .section-info-field .field-content.project .field{display:block}.info-section .section-info-field .field-content.contact,.info-section .section-info-field .field-content.contact .info,.info-section .section-info-field .field-content.contact .text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.price-label{display:inline-block;padding:1px 5px 0;border:1px solid var(--sr-border-color);border-radius:9px;color:var(--sr-green);font-size:14px;font-weight:600;line-height:15px}@media (min-width:768px){.info-section{padding:23px 24px 21px}.info-section .section-body{margin:10px 0 6px}.info-section .section-info-field .field-content.project .price-label{display:inline-block;margin:0}.info-section .section-info-field .field-content.project .project-name{margin-right:5px}.info-section .section-info-field .field-content.project .icon-wrapper{width:32px;display:flex;justify-content:center;margin-right:12px}.info-section .section-info-field .field-content.project .divider{display:inline-block;margin:0 2px;color:var(--sr-light-text-color)}.info-section .section-info-field .field-content.project .field{display:inline-block}}@media (min-width:1024px){::-webkit-scrollbar-track{background:var(--base-gray-3)}::-webkit-scrollbar{background:0 0}::-webkit-scrollbar-thumb{background:var(--base-gray-16);border-radius:calc(5px / 2)}::-webkit-scrollbar:vertical{width:5px}::-webkit-scrollbar:horizontal{height:5px}}@media (min-width:1280px){.info-section .section-info-field{position:relative;cursor:pointer}.info-section .section-info-field sr-actions{opacity:0;visibility:hidden;transition:250ms}.info-section .section-info-field:hover sr-actions{opacity:1;visibility:visible}}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:0;width:100%}.contacts-list-container{position:relative}.contacts-list-container .group-title-wrapper{background:var(--white);z-index:3}.contacts-list-container .group-title-wrapper .group-title{position:relative;padding-left:56px;background-color:var(--base-gray-3);color:var(--base-gray-64);line-height:24px;text-transform:uppercase}.scroller{position:relative}.sticker{padding-left:56px;color:var(--base-gray-64);line-height:24px;text-transform:uppercase;position:absolute;width:100%;z-index:10;background:#f9f9f9;left:0}@media (min-width:768px){.contacts-list-container .group-title-wrapper .group-title,.sticker{padding-left:68px}}"]}]}],kt.ctorParameters=function(){return[{type:undefined,decorators:[{type:x.Inject,args:["storageService"]}]},{type:undefined,decorators:[{type:x.Inject,args:["urlUtils"]}]},{type:undefined,decorators:[{type:x.Inject,args:["appService"]}]},{type:J},{type:pt},{type:p.Router},{type:x.ChangeDetectorRef},{type:Z}]},kt.propDecorators={rightPanel:[{type:x.ViewChild,args:["rightPanel"]}],viewPort:[{type:x.ViewChild,args:["viewPort"]}]},kt);function kt(t,e,n,i,o,r,a,s){this.storageService=t,this.urlUtils=e,this.appService=n,this.contactsHelper=i,this.contactListGQL=o,this.router=r,this.cd=a,this.keyboardHelper=s,this.windowWidth=window.innerWidth,this.menuData=F,this.showMenu=!1,this.menuItems=B,this.contactsList=[],this.contactsCopy=[],this.unsubscribe$=new b.Subject,this.isMobile=this.contactsHelper.isMobile,this.mobileHeight=this.contactsHelper.getMobileHeight("152px"),this.searchText="",this.itemsPerPage=100,this.page=1,this.getActiveLanguage(),this.setContactsGql(),this.contactsHelper.headerData.next({title:$,path:"/"})}var Ct=(jt.prototype.ngOnChanges=function(){if(this.items){var t=this.items.find(function(t){return t.active});this.selectedMenu=t.label+" ("+t.count+")",this.clickEvent(t)}},jt.prototype.clickEvent=function(t){this.items.forEach(function(t){t.active=!1}),t.active=!0,this.selectedMenu=t.label+" ("+t.count+")",this.selectedEvent.emit(t)},jt.decorators=[{type:x.Component,args:[{selector:"lib-selected-menu",template:'<sr-menu\n  menuButtonType="text"\n  xPosition="after"\n  yPosition="below"\n  [buttonText]="selectedMenu"\n  svgIcon="chevron-down"\n  customMenuClass="filter-menu"\n>\n  <sr-menu-body>\n    <sr-menu-item\n      (click)="clickEvent(item)"\n      [hasCheckMark]="true"\n      [class.active]="item.active"\n      *ngFor="let item of items"\n      itemsPosition="between"\n    >\n      <sr-text>{{ item.label }} ({{ item.count }})</sr-text>\n    </sr-menu-item>\n  </sr-menu-body>\n</sr-menu>\n',styles:[""]}]}],jt.propDecorators={items:[{type:x.Input}],selectedEvent:[{type:x.Output}]},jt);function jt(){this.selectedEvent=new x.EventEmitter}var Pt=(St.prototype.ngOnDestroy=function(){this.unsubscribe.next(),this.unsubscribe.complete()},St.prototype.getDomains=function(){return P(this,void 0,void 0,function(){var e,n;return S(this,function(t){switch(t.label){case 0:return[4,this.storageService.getValue(E)];case 1:return e=t.sent(),[4,this.contactsHelper.getActiveDomain()];case 2:return n=t.sent(),this.activeDomainName=n,this.domains=e.filter(function(t){if(t.name.toLowerCase()!==n)return Object.assign(t,{name:t.name.toLowerCase()})}),[2]}})})},St.prototype.handleChangeDomain=function(t){this.appService.handleChangeDomain(t),this.activeDomainName=t},St.prototype.style=function(t){var e="var("+t+")";return this.sanitizer.bypassSecurityTrustStyle("--color-stop-1: "+e+"; --color-stop-2: var(--sr-gradient-blue)")},St.prototype.getRoot=function(){var e=this;this.headerData$.pipe(v.take(1)).subscribe(function(t){return e.router.navigate([t.path])})},St.prototype.getNotificationPage=function(){this.router.navigate(["/"+A])},St.prototype.logout=function(){this.appService.logout()},St.decorators=[{type:x.Component,args:[{selector:"lib-header",template:'<sr-header>\n  <sr-header-inner-block blockPosition="left">\n    <sr-button\n      (clickHandler)="getRoot()"\n      buttonType="icon"\n      svgIcon="arrow-left"\n    ></sr-button>\n    <sr-heading\n      *ngIf="!isMobile"\n      [headingText]="(headerData$ | async)?.title"\n      headingType="h1"\n    ></sr-heading>\n  </sr-header-inner-block>\n\n  <sr-header-title *ngIf="!isMobile">\n    <sr-icon\n      [style]="style(\'--sr-gradient-cyan\')"\n      svgIcon="ic-c"\n      iconSize="36"\n    ></sr-icon>\n  </sr-header-title>\n\n  <sr-header-inner-block blockPosition="right">\n    <sr-menu\n      menuButtonType="icon"\n      svgIcon="notifications"\n      badgeContent="2"\n      xPosition="before"\n      yPosition="below"\n      customMenuClass="notifications header-menu"\n    >\n      <sr-menu-body noPadding="true">\n        <sr-notifications\n          [data]="[\n            {\n              text:\n                \'<b>Michael Klein</b> has shared the <b>Werden Bau</b> project with you.\',\n              time: \'5h\',\n              unread: true\n            },\n            {\n              text: \'You have a new message from <b>Andreas Kolt.</b>\',\n              time: \'Yesterday\',\n              unread: true\n            },\n            {\n              text:\n                \'<b>Martina Müller</b> has shared the <b>Dogo Gartenbau</b> contact with you.\',\n              time: \'May 27\',\n              unread: true\n            },\n            {\n              text: \'You have joined to <b>Sorba Web Container</b>.\',\n              time: \'January 5, 2018\',\n              unread: false\n            }\n          ]"\n        ></sr-notifications>\n      </sr-menu-body>\n      <sr-button\n        buttonType="additional"\n        [isBoxed]="true"\n        (click)="getNotificationPage()"\n        buttonText="Show all"\n      ></sr-button>\n    </sr-menu>\n\n    <sr-menu\n      *ngIf="activeDomainName"\n      menuButtonType="avatar"\n      xPosition="before"\n      yPosition="below"\n      [avatarValue]="activeDomainName[0]"\n      customMenuClass="domains header-menu"\n    >\n      <sr-menu-header class="main-menu-item">\n        <sr-avatar\n          [avatarSize]="48"\n          [avatarValue]="activeDomainName[0]"\n        ></sr-avatar>\n        <sr-text>{{ activeDomainName }}</sr-text>\n      </sr-menu-header>\n\n      <sr-menu-body>\n        <sr-menu-item\n          *ngFor="let domain of domains"\n          (click)="handleChangeDomain(domain?.name)"\n        >\n          <sr-avatar\n            [avatarSize]="40"\n            [avatarValue]="(domain?.name)[0]"\n          ></sr-avatar>\n          <sr-text>{{ domain?.name }}</sr-text>\n        </sr-menu-item>\n      </sr-menu-body>\n\n      <sr-menu-footer itemsPosition="end">\n        <sr-button\n          buttonType="primary"\n          buttonText="Sign out"\n          (clickHandler)="logout()"\n        ></sr-button>\n      </sr-menu-footer>\n    </sr-menu>\n  </sr-header-inner-block>\n</sr-header>\n',styles:[""]}]}],St.ctorParameters=function(){return[{type:undefined,decorators:[{type:x.Inject,args:["storageService"]}]},{type:undefined,decorators:[{type:x.Inject,args:["appService"]}]},{type:l.DomSanitizer},{type:p.Router},{type:J}]},St);function St(t,e,n,i,o){this.storageService=t,this.appService=e,this.sanitizer=n,this.router=i,this.contactsHelper=o,this.isMobile=this.contactsHelper.isMobile,this.unsubscribe=new b.Subject,this.headerData$=this.contactsHelper.headerData,this.storageService.getValue(E),this.getDomains()}var Mt=(Ht.prototype.ngOnChanges=function(){this.searchList&&(this.searchListCopy=this.searchList,this.searchContact(this.searchText))},Ht.prototype.ngOnDestroy=function(){this.subject.next(),this.subject.complete()},Ht.prototype.selectContact=function(t){this.selectContactItem.emit(t)},Ht.prototype.clearInput=function(){this.search.setValue("")},Ht.prototype.trackByFn=function(t,e){return e.id||t},Ht.prototype.searchContact=function(t){this.searchText=t,this.searchEvent.emit(t),this.setTagHighLight(t),this.searchList=this.contactsHelper.searchBySymbol(this.searchListCopy,t)},Ht.prototype.setTagHighLight=function(t){var l=this;if(t.length){var p=new RegExp(function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(t),"ig");setTimeout(function(){var t,e;if(l.searchContent&&l.searchContent.nativeElement){var n=l.searchContent.nativeElement.getElementsByClassName("info-field");if(n.length){var i=void 0;try{for(var o=M(n),r=o.next();!r.done;r=o.next()){var a=(i=r.value).textContent.match(p),s=a&&a.length&&a[0];i.innerHTML=i.textContent.replace(p,'<span class="highlight">'+s+"</span>")}}catch(c){t={error:c}}finally{try{r&&!r.done&&(e=o["return"])&&e.call(o)}finally{if(t)throw t.error}}}}})}},Ht.decorators=[{type:x.Component,args:[{selector:"lib-search-contacts",template:'<div class="bottom-block">\n  <div class="search-field">\n    <div class="input-wrapper">\n      <sr-icon svgIcon="search" class="search-icon"></sr-icon>\n      <input type="search" placeholder="Search" [formControl]="search" />\n      <sr-button\n        *ngIf="search.value.length"\n        buttonType="icon"\n        svgIcon="cross"\n        (clickHandler)="clearInput()"\n      ></sr-button>\n    </div>\n\n    <div *ngIf="search.value.length" class="search-result" #searchContent>\n      <ng-container *ngIf="searchList.length; else notFount">\n        <lib-scroller\n          [activeItemId]="(contactsHelper.activeContact | async)?.id"\n          [grouping]="false"\n          [scrollHeight]="scrollHeight"\n          [contacts]="searchList"\n          (selectContact)="selectContact($event)"\n        ></lib-scroller>\n      </ng-container>\n\n      <ng-template #notFount>\n        <span class="no-data">No match data ...</span>\n      </ng-template>\n    </div>\n  </div>\n</div>\n',styles:[""]}]}],Ht.ctorParameters=function(){return[{type:J}]},Ht.propDecorators={searchContent:[{type:x.ViewChild,args:["searchContent"]}],searchList:[{type:x.Input}],scrollHeight:[{type:x.Input}],searchEvent:[{type:x.Output}],selectContactItem:[{type:x.Output}]},Ht);function Ht(t){var e=this;this.contactsHelper=t,this.searchEvent=new x.EventEmitter,this.selectContactItem=new x.EventEmitter,this.search=new u.FormControl(""),this.subject=new b.Subject,this.searchText="",this.search.valueChanges.pipe(v.takeUntil(this.subject)).subscribe(function(t){return e.searchContact(t)})}var Tt,Dt,At=d(Dt=Dt||H(["\n  query AppProjects($domain: String!, $page: UInt!, $perPage: UInt!) {\n    projectApps(domain: $domain, page: $page, perPage: $perPage) {\n      items {\n        id\n        name\n        description\n        order_no\n        offer_total\n        responsible\n        denied\n        done\n        warranty\n        in_progress\n        do_not_calculate\n        acquisition\n        replicating\n        archives\n        offer\n      }\n      pageInfo {\n        totalCount\n      }\n    }\n  }\n"],["\n  query AppProjects($domain: String!, $page: UInt!, $perPage: UInt!) {\n    projectApps(domain: $domain, page: $page, perPage: $perPage) {\n      items {\n        id\n        name\n        description\n        order_no\n        offer_total\n        responsible\n        denied\n        done\n        warranty\n        in_progress\n        do_not_calculate\n        acquisition\n        replicating\n        archives\n        offer\n      }\n      pageInfo {\n        totalCount\n      }\n    }\n  }\n"])),$t=(C(Lt,Tt=w.Query),Lt.decorators=[{type:x.Injectable,args:[{providedIn:"root"}]}],Lt.ngInjectableDef=x.defineInjectable({factory:function(){return new Lt(x.inject(w.Apollo))},token:Lt,providedIn:"root"}),Lt);function Lt(){var t=null!==Tt&&Tt.apply(this,arguments)||this;return t.document=At,t}var _t=(Ot.prototype.initContactDetailsQuery=function(){return P(this,void 0,void 0,function(){var e,n=this;return S(this,function(t){switch(t.label){case 0:return[4,this.contactHelper.getActiveDomain()];case 1:return e=t.sent(),this.contactSub$.pipe(v.switchMap(function(t){return n.contactByIdGQL.fetch({id:t.id,domain:e}).pipe(v.map(function(t){return t.data.contactAppById}))})).subscribe(function(t){t&&Object.assign(n.contact,t)}),[2]}})})},Ot.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},Ot.prototype.getContactProjects=function(){return P(this,void 0,void 0,function(){var e,n=this;return S(this,function(t){switch(t.label){case 0:return[4,this.contactHelper.getActiveDomain()];case 1:return e=t.sent(),this.appProjectsQuery=this.appProjectsService.watch({domain:e,page:this.page,perPage:this.itemsPerPage}),this.appProjectsQuery.valueChanges.pipe(v.takeUntil(this.unsubscribe$)).subscribe(function(t){var e=t.data;n.appProjects=e.projectApps.items,n.totalProjectsCount=e.projectApps.pageInfo.totalCount}),[2]}})})},Ot.prototype.fetchLess=function(){this.appProjectSliceEnd=this.itemsPerPage},Ot.prototype.getFullName=function(t){if(t)return wt([t.first_name,t.name])},Ot.prototype.fetchMore=function(){var i=this;this.totalProjectsCount<=this.appProjects.length?this.appProjectSliceEnd=undefined:this.appProjectsQuery.fetchMore({variables:{page:this.page,perPage:this.totalProjectsCount},updateQuery:function(t,e){var n=e.fetchMoreResult;return i.appProjectSliceEnd=undefined,n||t}})},Ot.prototype.getField=function(t){return t&&t.length?t:" - "},Ot.prototype.getAddress=function(t,e){return void 0===e&&(e=","),t&&t.length?""+t+(e||""):""},Ot.prototype.trackByFn=function(t,e){return e.id||t},Ot.prototype.getStatus=function(t){switch(!0){case t.specification:return"Specification";case t.offer:return"Offer";case t.done:return"Done";case t.denied:return"Denied";case t.in_progress:default:return"In progress"}},Ot.decorators=[{type:x.Component,args:[{selector:"lib-contact-detail",template:'<lib-contact-actions [fullName]="getFullName(contact)"></lib-contact-actions>\n\n<div class="main-info-section">\n  <sr-heading headingText="Contact Details" headingType="h3"></sr-heading>\n\n  <ul class="info-list">\n    <li class="info-list-item">\n      <div class="cell label">Business number</div>\n      <div class="cell value">\n        <sr-text>{{ getField(contact.business_number) }}</sr-text>\n      </div>\n    </li>\n    <li class="info-list-item">\n      <div class="cell label">Mobile number</div>\n      <div class="cell value">\n        <sr-text>{{ getField(contact.mobile_number) }}</sr-text>\n      </div>\n    </li>\n    <li class="info-list-item">\n      <div class="cell label">Private Number</div>\n      <div class="cell value">\n        <sr-text>{{ getField(contact.private_number) }}</sr-text>\n      </div>\n    </li>\n    <li class="info-list-item">\n      <div class="cell label">Fax</div>\n      <div class="cell value">\n        <sr-text>{{ getField(contact.fax) }}</sr-text>\n      </div>\n    </li>\n    <li class="info-list-item">\n      <div class="cell label">Email</div>\n      <div class="cell value">\n        <sr-text>{{ getField(contact.email) }}</sr-text>\n      </div>\n    </li>\n    <li class="info-list-item">\n      <div class="cell label">Website</div>\n      <div class="cell value">\n        <sr-text>{{ getField(contact.website) }}</sr-text>\n      </div>\n    </li>\n    <li class="info-list-item">\n      <div class="cell label">Address</div>\n      <div class="cell value">\n        <sr-text>{{ getAddress(contact.address) }}</sr-text>\n        <sr-text\n          >{{ contact.postal_code }}\n          {{ contact.city }}\n          {{ contact.po_box ? \',\' : \'\' }}</sr-text\n        >\n        <sr-text>{{ contact.po_box }}</sr-text>\n      </div>\n    </li>\n  </ul>\n  <div class="map-container">\n    <agm-map\n      [latitude]="contact?.geocode_address?.lat"\n      [longitude]="contact?.geocode_address?.lon"\n      [draggable]="false"\n      [panControl]="false"\n      [zoom]="15"\n      [scaleControl]="false"\n      [zoomControl]="false"\n    >\n      <agm-marker\n        [latitude]="contact?.geocode_address?.lat"\n        [longitude]="contact?.geocode_address?.lon"\n      ></agm-marker>\n    </agm-map>\n  </div>\n</div>\n\n<div class="info-section">\n  <header class="section-header">\n    <sr-heading headingText="notes" headingType="h3"></sr-heading>\n    <sr-button buttonType="icon" svgIcon="add-circle"></sr-button>\n  </header>\n  <div class="section-body">\n    <div class="section-info-field">\n      <div class="field-content">\n        <sr-text\n          >The company team is very qualified, so just follow the solutions that\n          will be provided and enjoy with a result.\n        </sr-text>\n      </div>\n      <sr-actions [windowWidth]="windowWidth" [data]="actions"></sr-actions>\n    </div>\n  </div>\n</div>\n\n<div class="info-section">\n  <header class="section-header">\n    <sr-heading headingText="Contact Persons" headingType="h3"></sr-heading>\n    <sr-button buttonType="icon" svgIcon="add-circle"></sr-button>\n  </header>\n  <div class="section-body">\n    <div class="section-info-field">\n      <div class="field-content contact">\n        <sr-avatar avatarValue="y"></sr-avatar>\n        <div class="info">\n          <sr-link [linkUrl]="\'#/contacts/contact\'"\n            >Mrs. Alyssa Ashcroft</sr-link\n          >\n          <sr-text textType="complementary"\n            >Seestrasse 25, 9000 St. Gallen Seestrasse 25, 9000 St.\n            Gallen</sr-text\n          >\n        </div>\n      </div>\n      <sr-actions [windowWidth]="windowWidth" [data]="actions"></sr-actions>\n    </div>\n    <div class="section-info-field">\n      <div class="field-content contact">\n        <sr-avatar avatarValue="y"></sr-avatar>\n        <div class="info">\n          <sr-link [linkUrl]="\'#/contacts/contact\'"\n            >Mrs. Alyssa Ashcroft</sr-link\n          >\n          <sr-text textType="complementary"\n            >Seestrasse 25, 9000 St. Gallen Seestrasse 25, 9000 St.\n            Gallen</sr-text\n          >\n        </div>\n      </div>\n      <sr-actions [windowWidth]="windowWidth" [data]="actions"></sr-actions>\n    </div>\n    <div class="section-info-field">\n      <div class="field-content contact">\n        <sr-avatar avatarValue="y"></sr-avatar>\n        <div class="info">\n          <sr-link [linkUrl]="\'#/contacts/contact\'"\n            >Mrs. Alyssa Ashcroft</sr-link\n          >\n          <sr-text textType="complementary"\n            >Seestrasse 25, 9000 St. Gallen Seestrasse 25, 9000 St.\n            Gallen</sr-text\n          >\n        </div>\n      </div>\n      <sr-actions [windowWidth]="windowWidth" [data]="actions"></sr-actions>\n    </div>\n  </div>\n</div>\n\n<div class="info-section">\n  <header class="section-header">\n    <sr-heading headingText="Projects" headingType="h3"></sr-heading>\n    <sr-button buttonType="icon" svgIcon="add-circle"></sr-button>\n  </header>\n  <div class="section-body">\n    <div\n      class="section-info-field"\n      *ngFor="\n        let project of appProjects | slice: 0:appProjectSliceEnd;\n        trackBy: trackByFn\n      "\n    >\n      <div class="field-content project">\n        <div class="icon-wrapper">\n          <sr-font-icon iconName="case"></sr-font-icon>\n        </div>\n        <div class="info">\n          <div>\n            <a href="\'#/contacts/contact\'" class="project-name link">\n              {{ project.name }} {{ project.description }}\n            </a>\n            <span class="price-label" *ngIf="!isMobile">{{\n              project.offer_total | currency: \'EUR\'\n            }}</span>\n          </div>\n          <sr-text textType="complementary">\n            <span class="field order">Order-No.: {{ project.order_no }}</span>\n            <span class="divider">/</span>\n            <span class="field responsible"\n              >Responsible:\n              <a href="\'#/contacts/contact\'" class="link">{{\n                project.responsible || \'-\'\n              }}</a></span\n            >\n            <span class="divider">/</span>\n            <span class="field status">Status: {{ getStatus(project) }}</span>\n          </sr-text>\n          <span class="price-label" *ngIf="isMobile">{{\n            project.offer_total | currency: \'EUR\'\n          }}</span>\n        </div>\n      </div>\n      <sr-actions [windowWidth]="windowWidth" [data]="actions"></sr-actions>\n    </div>\n    <div class="button-wrapper">\n      <sr-button\n        (clickHandler)="fetchMore()"\n        *ngIf="appProjectSliceEnd > 0"\n        buttonText="Show more"\n        buttonType="link"\n      >\n      </sr-button>\n      <sr-button\n        (clickHandler)="fetchLess()"\n        *ngIf="!appProjectSliceEnd"\n        buttonText="Show less"\n        buttonType="link"\n      >\n      </sr-button>\n    </div>\n  </div>\n</div>\n',styles:["agm-map{height:160px}.main-info-section{padding:24px 12px}.main-info-section ::ng-deep .sub-heading{margin-bottom:14px;color:var(--base-gray-48)}.main-info-section .info-list-item:not(:last-child){padding-bottom:9px}.main-info-section .info-list-item .value{color:var(--sr-base-color)}.main-info-section .map-container{margin-top:23px}@media (min-width:768px){agm-map{height:216px}.main-info-section{padding:29px 24px 31px}.main-info-section .info-list-item{display:table-row}.main-info-section .info-list-item:not(:last-child) .cell{padding-bottom:8px}.main-info-section .info-list-item .cell{display:table-cell}.main-info-section .info-list-item .label{padding-right:14px;text-align:right}.main-info-section .map-container{height:216px;margin-top:31px}}"]}]}],Ot.ctorParameters=function(){return[{type:yt},{type:J},{type:$t}]},Ot);function Ot(t,e,n){var i=this;this.contactByIdGQL=t,this.contactHelper=e,this.appProjectsService=n,this.unsubscribe$=new b.Subject,this.windowWidth=window.innerWidth,this.actions=[{icon:"edit",text:"Edit",handler:function(){return console.log("edit")}},{icon:"delete",text:"Delete",handler:function(){return console.log("delete")}}],this.itemsPerPage=3,this.page=1,this.appProjects=[],this.totalProjectsCount=0,this.appProjectSliceEnd=this.itemsPerPage,this.isMobile=this.contactHelper.isMobile,this.contactSub$=this.contactHelper.activeContact.pipe(v.takeUntil(this.unsubscribe$),v.distinctUntilChanged()),this.contactSub$.subscribe(function(t){i.contact?(Object.assign(i.contact,t),i.fetchLess()):i.contact=j({},t)}),this.initContactDetailsQuery(),this.getContactProjects(),this.isMobile&&this.contactHelper.headerData.next({path:"/"+T+"/"+D,title:""})}var Et=(Object.defineProperty(qt.prototype,"avatarSize",{get:function(){return window.innerWidth<768?36:40},enumerable:!0,configurable:!0}),Object.defineProperty(qt.prototype,"showContact",{get:function(){return window.innerWidth<768},enumerable:!0,configurable:!0}),Object.defineProperty(qt.prototype,"showActions",{get:function(){return 767<window.innerWidth},enumerable:!0,configurable:!0}),qt.decorators=[{type:x.Component,args:[{selector:"lib-contact-actions",template:'<header class="contact-details-header">\n  <div class="contact-base-info">\n    <sr-avatar\n      [avatarValue]="fullName.charAt(0)"\n      [avatarSize]="avatarSize"\n    ></sr-avatar>\n    <sr-heading [headingText]="fullName"></sr-heading>\n  </div>\n\n  <div class="contact-actions" *ngIf="showContact">\n    <sr-menu\n      menuButtonType="icon"\n      svgIcon="more-vertical"\n      class="contact-actions"\n    >\n      <sr-menu-body>\n        <sr-menu-item\n          [hasCheckMark]="true"\n          itemsPosition="between"\n          class="contact-action"\n        >\n          <sr-icon svgIcon="file-export"></sr-icon>\n          <sr-text>Export</sr-text>\n        </sr-menu-item>\n        <sr-menu-item\n          [hasCheckMark]="true"\n          itemsPosition="between"\n          class="contact-action"\n        >\n          <sr-icon svgIcon="print"></sr-icon>\n          <sr-text>Print</sr-text>\n        </sr-menu-item>\n        <sr-menu-item\n          [hasCheckMark]="true"\n          itemsPosition="between"\n          class="contact-action"\n        >\n          <sr-icon svgIcon="edit"></sr-icon>\n          <sr-text>Edit</sr-text>\n        </sr-menu-item>\n        <sr-menu-item [hasCheckMark]="true" class="contact-action">\n          <sr-icon svgIcon="delete"></sr-icon>\n          <sr-text>Delete</sr-text>\n        </sr-menu-item>\n      </sr-menu-body>\n    </sr-menu>\n  </div>\n\n  <div class="contact-actions" *ngIf="showActions">\n    <sr-button buttonType="icon" svgIcon="file-export"></sr-button>\n    <sr-button buttonType="icon" svgIcon="print"></sr-button>\n    <sr-button buttonType="icon" svgIcon="edit"></sr-button>\n    <sr-button buttonType="icon" svgIcon="delete"></sr-button>\n    <span class="divider"></span>\n    <sr-button buttonType="icon" svgIcon="three-column-view"></sr-button>\n  </div>\n</header>\n',styles:[".contact-details-header{display:flex;align-items:center;justify-content:space-between;padding:13px 12px 10px;border-bottom:1px solid var(--sr-border-color)}.contact-details-header sr-avatar{margin-right:8px}.contact-details-header sr-heading{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.contact-details-header ::ng-deep .heading{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.contact-base-info{display:flex;align-items:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.contact-action sr-icon{margin-right:16px;color:var(--base-gray-64)}@media (min-width:768px){.contact-details-header{padding:16px 16px 16px 24px}.contact-details-header sr-avatar{margin-right:12px}.contact-details-header sr-button{margin-left:8px}.contact-details-header .divider{width:1px;margin-left:8px;background:var(--sr-border-color)}.contact-details-header .contact-actions{display:flex}}"]}]}],qt.ctorParameters=function(){return[]},qt.propDecorators={fullName:[{type:x.Input}]},qt);function qt(){}var Bt=(Ft.prototype.ngOnDestroy=function(){this.subject.next(),this.subject.complete()},Object.defineProperty(Ft.prototype,"getText",{get:function(){return this.isDesktop?this.policy:this.privacy},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"buttonText",{get:function(){return this.isDesktop?this.service:this.terms},enumerable:!0,configurable:!0}),Object.defineProperty(Ft.prototype,"getHelpText",{get:function(){return this.isDesktop?this.center:this.help},enumerable:!0,configurable:!0}),Ft.prototype.getLanguages=function(){this.languages$=this.languageGql.watch().valueChanges.pipe(v.pluck("data","languages"))},Ft.prototype.getHelpCenter=function(t){this.linkRedirect.redirect(t,this.helpCenter)},Ft.prototype.handleChangeLanguage=function(e){return P(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:return e===this.activeLanguage?[2,null]:[4,this.appService.changeLanguage(e)];case 1:return t.sent(),this.contactsHelper.activeLanguage$.next(e),[2]}})})},Ft.prototype.uppercase=function(t){return t.charAt(0).toUpperCase()+t.substr(1,t.length-1).toLowerCase()},Ft.decorators=[{type:x.Component,args:[{selector:"lib-footer",template:'<sr-footer *ngIf="!isMobile">\n  <div class="row">\n    <div class="col xs-4 m-4 l-5">\n      <sr-text class="copyright">&copy; 2019 Sorba</sr-text>\n    </div>\n    <div class="col xs-8 m-4 l-5 last-m">\n      <sr-buttons-group buttonsPosition="end">\n        <sr-link linkColor="gray" linkSize="small" [linkUrl]="privacyPolicy">{{\n          getText\n        }}</sr-link>\n        \x3c!--        <sr-link linkColor="gray" linkSize="small">--\x3e\n        \x3c!--          {{isDesktop ? \'Terms of Service\' : \'Terms\'}}--\x3e\n        \x3c!--        </sr-link>--\x3e\n        <lib-terms-button [buttonText]="buttonText"></lib-terms-button>\n        <sr-link\n          linkColor="gray"\n          linkSize="small"\n          (click)="getHelpCenter($event)"\n          >{{ getHelpText }}</sr-link\n        >\n      </sr-buttons-group>\n    </div>\n    <div class="col m-4 l-2">\n      <sr-buttons-group buttonsPosition="center">\n        <sr-menu\n          menuButtonType="text"\n          xPosition="after"\n          yPosition="above"\n          [buttonText]="uppercase(activeLanguage)"\n          svgIcon="language"\n          customMenuClass="languages footer-menu"\n        >\n          <sr-menu-body>\n            <sr-menu-item\n              *ngFor="let language of languages$ | async"\n              [hasCheckMark]="true"\n              (click)="handleChangeLanguage(language)"\n              [class.active]="language === activeLanguage"\n              itemsPosition="between"\n            >\n              <sr-text>{{ uppercase(language) }}</sr-text>\n            </sr-menu-item>\n          </sr-menu-body>\n        </sr-menu>\n      </sr-buttons-group>\n    </div>\n  </div>\n</sr-footer>\n',styles:[""]}]}],Ft.ctorParameters=function(){return[{type:et},{type:J},{type:ft},{type:undefined,decorators:[{type:x.Inject,args:["appService"]}]}]},Ft);function Ft(t,e,n,i){var o=this;this.linkRedirect=t,this.contactsHelper=e,this.languageGql=n,this.appService=i,this.isMobile=this.contactsHelper.isMobile,this.isDesktop=this.contactsHelper.isDesktop,this.privacyPolicy="#/"+N,this.helpCenter=W,this.privacy="Privacy",this.policy="Privacy Policy",this.service="Terms of Service",this.terms="Terms",this.center="Help Center",this.help="Help",this.subject=new b.Subject,this.getLanguages(),this.contactsHelper.activeLanguage$.pipe(v.takeUntil(this.subject)).subscribe(function(t){return o.activeLanguage=t})}var Nt=(Ut.prototype.openTermsOfService=function(){var e=this,t=this.file.applicationDirectory+"www/assets/docs",n="2019_AGB_SORBA_EDV_AG.pdf",i="application/pdf";if(this.platformHelper.isIOS())this.document.viewDocument(t+"/"+n,i,{});else if(this.platformHelper.isAndroid()){var o=Date.now();this.file.copyFile(t,n,this.file.dataDirectory,o+".pdf").then(function(t){e.fileOpener.open(t.nativeURL,i)["catch"](function(t){return console.log(t)})})}},Ut.decorators=[{type:x.Component,args:[{selector:"lib-terms-button",template:'<sr-button\n  *ngIf="!platformHelper.isDesktop()"\n  buttonType="text"\n  (clickHandler)="openTermsOfService()"\n  >{{ buttonText }}</sr-button\n>\n<sr-link\n  *ngIf="platformHelper.isDesktop()"\n  (click)="linkRedirect.redirect($event, termsOfService)"\n  linkColor="gray"\n  linkSize="small"\n>\n  {{ buttonText }}\n</sr-link>\n',styles:[""]}]}],Ut.ctorParameters=function(){return[{type:et},{type:h.DocumentViewer},{type:f.File},{type:g.FileOpener},{type:it}]},Ut.propDecorators={buttonText:[{type:x.Input}]},Ut);function Ut(t,e,n,i,o){this.linkRedirect=t,this.document=e,this.file=n,this.fileOpener=i,this.platformHelper=o,this.termsOfService=U}var Wt=(Object.defineProperty(zt.prototype,"isAllLoaded",{get:function(){return this.totalCountContacts!==this.contacts.length},enumerable:!0,configurable:!0}),zt.prototype.ngAfterViewInit=function(){this.getViewScroll(),this.contactHelper.isMobile&&this.setHeightForScroll()},zt.prototype.ngOnChanges=function(){this.loading=!1,this.scrollHeight&&this.setHeightViewScroll(this.scrollHeight+"px")},zt.prototype.ngOnDestroy=function(){this.subject.next(),this.subject.complete()},zt.prototype.setHeightForScroll=function(){var t=this.platform.height();this.setHeightViewScroll(t-220+"px")},zt.prototype.setHeightViewScroll=function(t){this.viewPort.elementRef.nativeElement.style.height=t,this.viewPort.checkViewportSize()},zt.prototype.groupContacts=function(t,e,n){if(0===e)return this.getFirstChar(t.text);var i=this.getFirstChar(n[e-1].text),o=this.getFirstChar(n[e].text);return i!==o?o:null},zt.prototype.trackByFn=function(t,e){return e.id||t},zt.prototype.onSelectContactItem=function(t){this.selectContact.emit(t)},zt.prototype.getFirstChar=function(t){return t.trim().charAt(0).toUpperCase()},zt.prototype.getViewScroll=function(){var e=this;this.viewPort&&this.totalCountContacts&&this.viewPort.scrolledIndexChange.pipe(v.auditTime(300),v.filter(function(){return!1===e.loading}),v.tap(function(){return e.nextBatch()}),v.takeUntil(this.subject)).subscribe(function(t){e.contacts&&e.contacts[t]&&e.contacts[t].text&&(e.sticker=e.contacts[t].text[0])})},zt.prototype.nextBatch=function(){if(this.viewPort&&this.isAllLoaded){var t=this.viewPort.getRenderedRange().end;this.viewPort.getDataLength()===t&&(this.fetchMore.emit(),this.loading=!0)}},zt.decorators=[{type:x.Component,args:[{selector:"lib-scroller",template:'<div class="scroller-wrapper">\n  <p class="sticker">{{ sticker }}</p>\n\n  <cdk-virtual-scroll-viewport\n    class="scroller"\n    #viewPort\n    [itemSize]="itemSize"\n    [minBufferPx]="itemSize"\n    [maxBufferPx]="itemSize"\n  >\n    <div class="contacts-list-container">\n      <ng-container\n        *cdkVirtualFor="let item of contacts; let i = index; trackBy: trackByFn"\n      >\n        <div class="contacts-group">\n          <div\n            class="group-title-wrapper"\n            *ngIf="grouping && groupContacts(item, i, contacts) as char"\n          >\n            <div class="group-title">\n              {{ char }}\n            </div>\n          </div>\n          <sr-contact-item\n            [data]="item"\n            [windowWidth]="windowWidth"\n            [hasActions]="true"\n            [activeItemId]="activeItemId"\n            (click)="onSelectContactItem(item)"\n          >\n          </sr-contact-item>\n        </div>\n      </ng-container>\n    </div>\n\n    <ng-container *ngIf="loading">\n      <div class="loader">\n        <ion-spinner></ion-spinner>\n      </div>\n    </ng-container>\n  </cdk-virtual-scroll-viewport>\n</div>\n',styles:[".loader{height:50px}.scroller-wrapper{position:relative}"]}]}],zt.ctorParameters=function(){return[{type:m.Platform},{type:J},{type:Z}]},zt.propDecorators={viewPort:[{type:x.ViewChild,args:["viewPort"]}],grouping:[{type:x.Input}],contacts:[{type:x.Input}],scrollHeight:[{type:x.Input}],totalCountContacts:[{type:x.Input}],activeItemId:[{type:x.Input}],fetchMore:[{type:x.Output}],selectContact:[{type:x.Output}]},zt);function zt(t,e,n){var i=this;this.platform=t,this.contactHelper=e,this.keyboardHelper=n,this.grouping=!0,this.fetchMore=new x.EventEmitter,this.selectContact=new x.EventEmitter,this.loading=!1,this.itemSize=50,this.windowWidth=window.innerWidth,this.subject=new b.Subject,this.keyboardHelper.keyboardHeight$.pipe(v.takeUntil(this.subject)).subscribe(function(t){t||i.setHeightForScroll()})}var Rt=(Vt.prototype.transform=function(t,e,n){return n&&t&&t.length&&t.length>e?t.substr(0,e)+" ...":t},Vt.decorators=[{type:x.Pipe,args:[{name:"stringLimit"}]}],Vt);function Vt(){}var Gt=(Qt.decorators=[{type:x.NgModule,args:[{imports:[a.SorbaUiComponentsModule,m.IonicModule,s.CommonModule,y.ScrollingModule,u.ReactiveFormsModule,c.AgmCoreModule.forRoot({apiKey:"AIzaSyBfnFP4_clqP63H0yaEUIEc84FhGK8y1Ng"})],exports:[a.SorbaUiComponentsModule,m.IonicModule,s.CommonModule,u.ReactiveFormsModule,Pt,Mt,Ct,_t,Et,Bt,Nt,Wt,Rt],declarations:[Pt,Mt,Ct,_t,Et,Bt,Nt,Wt,Rt],providers:[J,Z]}]}],Qt);function Qt(){}var Kt=(Yt.decorators=[{type:x.Component,args:[{selector:"lib-root-contact",template:'\n    <lib-header></lib-header>\n    <sr-content>\n      <sr-container noPadding="horizontal-top">\n        <router-outlet></router-outlet>\n      </sr-container>\n\n      <lib-footer></lib-footer>\n    </sr-content>\n  '}]}],Yt);function Yt(){}var Jt=new I.IntrospectionFragmentMatcher({introspectionQueryResultData:{__schema:{types:[{kind:"INTERFACE",name:"Node",possibleTypes:[{name:"User"},{name:"Session"},{name:"Permission"},{name:"Template"},{name:"App"},{name:"Company"}]}]}}});function Xt(){return{cache:new I.InMemoryCache({fragmentMatcher:Jt,addTypename:!0}),defaultOptions:{watchQuery:{errorPolicy:"all"},query:{errorPolicy:"all"},mutate:{errorPolicy:"all"}},connectToDevTools:!0}}var Zt=(te.decorators=[{type:x.NgModule,args:[{exports:[w.ApolloModule],providers:[{provide:w.APOLLO_OPTIONS,useFactory:Xt}]}]}],te);function te(){}var ee=[{path:"",component:Kt,children:[{path:"contact",component:It},{path:":id",component:_t},{path:"**",redirectTo:"contact"}]},{path:"**",redirectTo:""}],ne=(ie.decorators=[{type:x.NgModule,args:[{declarations:[It,Kt],exports:[It,Kt],imports:[Zt,Gt,p.RouterModule.forChild(ee)]}]}],ie);function ie(){}t.ContactsModule=ne,t.ɵm=Et,t.ɵl=_t,t.ɵn=Bt,t.ɵi=Pt,t.ɵp=Wt,t.ɵj=Mt,t.ɵk=Ct,t.ɵo=Nt,t.ɵq=Rt,t.ɵc=pt,t.ɵb=J,t.ɵd=Z,t.ɵh=Gt,t.ɵa=It,t.ɵg=Zt,t.ɵf=Xt,t.ɵe=Kt,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=contacts.umd.min.js.map